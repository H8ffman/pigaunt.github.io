<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer-when-downgrade"><title>状态压缩的动态规划 | PigAunt的博客</title><meta property="og:title" content="状态压缩的动态规划 - PigAunt的博客"><meta property="og:type" content="article"><meta property="article:published_time" content="2021-08-23T09:57:53+08:00"><meta property="article:modified_time" content="2021-08-23T09:57:53+08:00"><meta name=Keywords content="C++,OI,C#"><meta name=description content="状态压缩的动态规划"><meta name=author content="PigAunt"><meta property="og:url" content="https://www.pigaunt.top/post/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E7%8A%B6%E6%80%81%E5%8E%8B%E7%BC%A9%E7%9A%84%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=stylesheet href=/css/normalize.css><link rel=stylesheet href=/css/style.css><script type=text/javascript src=//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js></script><link rel=stylesheet href=/css/douban.css><link rel=stylesheet href=/css/other.css></head><body><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><a id=logo href=https://www.pigaunt.top>PigAunt的博客</a><p class=description>Hello, World!</p></div><div><nav id=nav-menu class=clearfix><a class=current href=https://www.pigaunt.top>首页</a>
<a href=https://www.pigaunt.top/archives/ title=归档>归档</a>
<a href=https://www.pigaunt.top/about/ title=关于>关于</a></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>状态压缩的动态规划</h1></header><date class="post-meta meta-date">2021年8月23日</date><div class=post-meta><span>|</span>
<span class=meta-category><a href=/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92>动态规划</a></span></div><div class=post-meta><span id=busuanzi_container_page_pv>|<span id=busuanzi_value_page_pv></span><span>
阅读</span></span></div><div class=post-content><h1 id=状态压缩的动态规划>状态压缩的动态规划</h1><h2 id=分类>分类</h2><p>基本有两种：</p><ul><li>棋盘式的动态规划（基于联通性）</li><li>集合式的动态规划</li></ul><h2 id=状态压缩>状态压缩</h2><p>利用某些手段（以二进制压缩为主）将复杂的状态处理后存储。</p><h2 id=分类-1>分类</h2><h3 id=棋盘式的动态规划>棋盘式的动态规划</h3><p>给你一个棋盘，要在棋盘上摆放一些东西，但又有一些限制，求方案数/最多摆放数量。这类问题一般将每一行（自上而下递推）或每一列（自左而右递推）的摆放情况压缩成一个二进制数，每一位对应一个位置的摆放情况，然后根据题目限制设计递推式。</p><h3 id=集合式的动态规划>集合式的动态规划</h3><p>其实和上面类似，也是将一组数二进制压缩成一个数，只不过这一组数不表示棋盘上的一行或一列。</p><h2 id=例题>例题</h2><p><a href=https://loj.ac/p/10170>LOJ-10170-国王</a> / <a href=https://loj.ac/p/2153>LOJ-2153-「SCOI2005」互不侵犯</a></p><p>本题属于<strong>棋盘式的动态规划</strong>。</p><p>可以发现，每一行的摆放情况只与上一行有关。并且每一行的摆放情况可以用一个二进制数表示。因此，我们用$f_{i, k, state}$表示放完$i$行，至多放$k$个，且第$i$行的摆放情况是$state$的最多摆放数量。</p><p>若用$s_i$、$s_j$分别表示相邻的两行，那么由于国王不能上下相邻，所以$s_i \land s_j$必须为$0$，又因为国王间至少隔2格，那么必须满足$s_i$、$s_j$、$s_i \lor s_j$没有相邻的两位都是$1$。</p><p>排除了错误的摆放情况，我们可以用一个<code>std::vector&lt;int></code>存储所有可能的情况，再用一个<code>std::vector&lt;int></code>的数组表示状态间的可能的转移。</p><p>为了减少计算，我们还可以用一个数组<code>count[state]</code>表示特定状态的国王个数。</p><p>**小技巧：最后不必枚举最后一行的状态再相加，可以递推到原有行数的下一行，用$f_{n + 1, m, 0}$表示答案。**</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#ff79c6>#include</span> <span style=color:#ff79c6>&lt;iostream&gt;</span><span style=color:#ff79c6>
</span><span style=color:#ff79c6>#include</span> <span style=color:#ff79c6>&lt;vector&gt;</span><span style=color:#ff79c6>
</span><span style=color:#ff79c6></span>
<span style=color:#ff79c6>const</span> <span style=color:#8be9fd>int</span> N <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>12</span>, M <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1024</span>, K <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>105</span>;

<span style=color:#8be9fd>int</span> n, m, count[M];
<span style=color:#8be9fd>long</span> <span style=color:#8be9fd>long</span> f[N][K][M];
std<span style=color:#ff79c6>::</span>vector<span style=color:#ff79c6>&lt;</span><span style=color:#8be9fd>int</span><span style=color:#ff79c6>&gt;</span> s;
std<span style=color:#ff79c6>::</span>vector<span style=color:#ff79c6>&lt;</span><span style=color:#8be9fd>int</span><span style=color:#ff79c6>&gt;</span> to[M];

<span style=color:#8be9fd>bool</span> <span style=color:#50fa7b>Check</span>(<span style=color:#8be9fd>int</span> state)
{
    <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> n; i<span style=color:#ff79c6>++</span>)
        <span style=color:#ff79c6>if</span> (((state <span style=color:#ff79c6>&gt;&gt;</span> i) <span style=color:#ff79c6>&amp;</span> <span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>&amp;&amp;</span> ((state <span style=color:#ff79c6>&gt;&gt;</span> (i <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>)) <span style=color:#ff79c6>&amp;</span> <span style=color:#bd93f9>1</span>))
            <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>false</span>;
    <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>true</span>;
}

<span style=color:#8be9fd>int</span> <span style=color:#50fa7b>CountKing</span>(<span style=color:#8be9fd>int</span> state)
{
    <span style=color:#8be9fd>int</span> res <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>;
    <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> n; i<span style=color:#ff79c6>++</span>)
        <span style=color:#ff79c6>if</span> ((state <span style=color:#ff79c6>&gt;&gt;</span> i) <span style=color:#ff79c6>&amp;</span> <span style=color:#bd93f9>1</span>)
            res<span style=color:#ff79c6>++</span>;
    <span style=color:#ff79c6>return</span> res;
}

<span style=color:#8be9fd>int</span> <span style=color:#50fa7b>main</span>()
{
    std<span style=color:#ff79c6>::</span>cin <span style=color:#ff79c6>&gt;&gt;</span> n <span style=color:#ff79c6>&gt;&gt;</span> m;
    
    <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> (<span style=color:#bd93f9>1</span> <span style=color:#ff79c6>&lt;&lt;</span> n); i<span style=color:#ff79c6>++</span>)
        <span style=color:#ff79c6>if</span> (Check(i))
        {
            s.push_back(i);
            count[i] <span style=color:#ff79c6>=</span> CountKing(i);
        }
    
    <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> s.size(); i<span style=color:#ff79c6>++</span>)
        <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> j <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; j <span style=color:#ff79c6>&lt;</span> s.size(); j<span style=color:#ff79c6>++</span>)
        {
            <span style=color:#8be9fd>int</span> prev <span style=color:#ff79c6>=</span> s[i], next <span style=color:#ff79c6>=</span> s[j];
            <span style=color:#ff79c6>if</span> (((prev <span style=color:#ff79c6>&amp;</span> next) <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>0</span>) <span style=color:#ff79c6>&amp;&amp;</span> Check(prev <span style=color:#ff79c6>|</span> next))
                to[i].push_back(j);
        }
    
    f[<span style=color:#bd93f9>0</span>][<span style=color:#bd93f9>0</span>][<span style=color:#bd93f9>0</span>] <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>;
    <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>; i <span style=color:#ff79c6>&lt;=</span> n <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>; i<span style=color:#ff79c6>++</span>)
        <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> j <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; j <span style=color:#ff79c6>&lt;=</span> m; j<span style=color:#ff79c6>++</span>)
            <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> prev <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; prev <span style=color:#ff79c6>&lt;</span> s.size(); prev<span style=color:#ff79c6>++</span>)
                <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> <span style=color:#8be9fd;font-style:italic>next</span> : to[prev])
                {
                    <span style=color:#8be9fd>int</span> c <span style=color:#ff79c6>=</span> count[s[prev]];
                    <span style=color:#ff79c6>if</span> (j <span style=color:#ff79c6>&gt;=</span> c)
                        f[i][j][next] <span style=color:#ff79c6>+=</span> f[i <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>][j <span style=color:#ff79c6>-</span> c][prev];
                }
    
    std<span style=color:#ff79c6>::</span>cout <span style=color:#ff79c6>&lt;&lt;</span> f[n <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>][m][<span style=color:#bd93f9>0</span>] <span style=color:#ff79c6>&lt;&lt;</span> std<span style=color:#ff79c6>::</span>endl;
    <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>0</span>;
}
</code></pre></td></tr></table></div></div><p><a href=https://www.acwing.com/problem/content/329/>AcWing-327-玉米田</a></p><p>与上一题类似，但要注意有的土地不能种。要排除那些种植情况，我们可以用一个数组<code>g[line]</code>表示该行不能种的情况（将不能种的位定为$1$），如果一个种植情况$state$和<code>g[line]</code>有公共的位置（即两者相与不为$0$），这个情况就要排除。</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#ff79c6>#include</span> <span style=color:#ff79c6>&lt;iostream&gt;</span><span style=color:#ff79c6>
</span><span style=color:#ff79c6>#include</span> <span style=color:#ff79c6>&lt;vector&gt;</span><span style=color:#ff79c6>
</span><span style=color:#ff79c6></span>
<span style=color:#ff79c6>const</span> <span style=color:#8be9fd>int</span> N <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>14</span>, M <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>4096</span>, MOD <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1e8</span>;

<span style=color:#8be9fd>int</span> n, m;
<span style=color:#8be9fd>int</span> g[N];
std<span style=color:#ff79c6>::</span>vector<span style=color:#ff79c6>&lt;</span><span style=color:#8be9fd>int</span><span style=color:#ff79c6>&gt;</span> s;
std<span style=color:#ff79c6>::</span>vector<span style=color:#ff79c6>&lt;</span><span style=color:#8be9fd>int</span><span style=color:#ff79c6>&gt;</span> to[M];
<span style=color:#8be9fd>int</span> f[N][M];

<span style=color:#8be9fd>bool</span> <span style=color:#50fa7b>Check</span>(<span style=color:#8be9fd>int</span> state)
{
    <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> m; i<span style=color:#ff79c6>++</span>)
        <span style=color:#ff79c6>if</span> (((state <span style=color:#ff79c6>&gt;&gt;</span> i) <span style=color:#ff79c6>&amp;</span> <span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>&amp;&amp;</span> ((state <span style=color:#ff79c6>&gt;&gt;</span> (i <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>)) <span style=color:#ff79c6>&amp;</span> <span style=color:#bd93f9>1</span>))
            <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>false</span>;
    <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>true</span>;
}

<span style=color:#8be9fd>int</span> <span style=color:#50fa7b>main</span>()
{
    std<span style=color:#ff79c6>::</span>cin <span style=color:#ff79c6>&gt;&gt;</span> n <span style=color:#ff79c6>&gt;&gt;</span> m;
    <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>; i <span style=color:#ff79c6>&lt;=</span> n; i<span style=color:#ff79c6>++</span>)
        <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> j <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; j <span style=color:#ff79c6>&lt;</span> m; j<span style=color:#ff79c6>++</span>)
        {
            <span style=color:#8be9fd>bool</span> t;
            std<span style=color:#ff79c6>::</span>cin <span style=color:#ff79c6>&gt;&gt;</span> t;
            g[i] <span style=color:#ff79c6>+=</span> (<span style=color:#ff79c6>!</span>t) <span style=color:#ff79c6>&lt;&lt;</span> j;
        }
    
    <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> (<span style=color:#bd93f9>1</span> <span style=color:#ff79c6>&lt;&lt;</span> m); i<span style=color:#ff79c6>++</span>)
        <span style=color:#ff79c6>if</span> (Check(i))
            s.push_back(i);
    
    <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> s.size(); i<span style=color:#ff79c6>++</span>)
        <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> j <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; j <span style=color:#ff79c6>&lt;</span> s.size(); j<span style=color:#ff79c6>++</span>)
        {
            <span style=color:#8be9fd>int</span> prev <span style=color:#ff79c6>=</span> s[i], next <span style=color:#ff79c6>=</span> s[j];
            <span style=color:#ff79c6>if</span> ((prev <span style=color:#ff79c6>&amp;</span> next) <span style=color:#ff79c6>==</span> <span style=color:#bd93f9>0</span>)
                to[i].push_back(j);
        }
        
    f[<span style=color:#bd93f9>0</span>][<span style=color:#bd93f9>0</span>] <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>;
    <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>; i <span style=color:#ff79c6>&lt;=</span> n <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>; i<span style=color:#ff79c6>++</span>)
        <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> prev <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; prev <span style=color:#ff79c6>&lt;</span> s.size(); prev<span style=color:#ff79c6>++</span>)
            <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> <span style=color:#8be9fd;font-style:italic>next</span> : to[prev])
            {
                <span style=color:#ff79c6>if</span> (g[i] <span style=color:#ff79c6>&amp;</span> s[next])
                    <span style=color:#ff79c6>continue</span>;
                f[i][next] <span style=color:#ff79c6>=</span> (f[i][next] <span style=color:#ff79c6>+</span> f[i <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>][prev]) <span style=color:#ff79c6>%</span> MOD;
            }
    
    std<span style=color:#ff79c6>::</span>cout <span style=color:#ff79c6>&lt;&lt;</span> f[n <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>][<span style=color:#bd93f9>0</span>] <span style=color:#ff79c6>&lt;&lt;</span> std<span style=color:#ff79c6>::</span>endl;
    <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>0</span>;
}
</code></pre></td></tr></table></div></div><p><a href=https://www.luogu.com.cn/problem/P2704>洛谷-P2704-[NOI2001] 炮兵阵地</a></p><p>与上一题类似，本题有的地方不能放炮兵部队。但本题与前面的区别在于，影响的范围多了一格，因此第$i$行的摆放情况与第$i - 1$行、第$i - 2$行有关。用$f_{i, s1, s2}$表示放完$i$行，第$i$行状态是$s1$、第$i - 1$行状态是$s2$。</p><p>为压缩空间，这里用了滚动数组。</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#ff79c6>#include</span> <span style=color:#ff79c6>&lt;iostream&gt;</span><span style=color:#ff79c6>
</span><span style=color:#ff79c6>#include</span> <span style=color:#ff79c6>&lt;vector&gt;</span><span style=color:#ff79c6>
</span><span style=color:#ff79c6></span>
<span style=color:#ff79c6>const</span> <span style=color:#8be9fd>int</span> N <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>105</span>, M <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>11</span>, K <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1024</span>;

<span style=color:#8be9fd>int</span> n, m;
<span style=color:#8be9fd>int</span> g[N], count[K];
std<span style=color:#ff79c6>::</span>vector<span style=color:#ff79c6>&lt;</span><span style=color:#8be9fd>int</span><span style=color:#ff79c6>&gt;</span> s;
<span style=color:#8be9fd>int</span> f[<span style=color:#bd93f9>2</span>][K][K];

<span style=color:#8be9fd>bool</span> <span style=color:#50fa7b>Check</span>(<span style=color:#8be9fd>int</span> state)
{
    <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> m; i<span style=color:#ff79c6>++</span>)
        <span style=color:#ff79c6>if</span> (((state <span style=color:#ff79c6>&gt;&gt;</span> i) <span style=color:#ff79c6>&amp;</span> <span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>&amp;&amp;</span> (((state <span style=color:#ff79c6>&gt;&gt;</span> (i <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>)) <span style=color:#ff79c6>&amp;</span> <span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>||</span> ((state <span style=color:#ff79c6>&gt;&gt;</span> (i <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>2</span>)) <span style=color:#ff79c6>&amp;</span> <span style=color:#bd93f9>1</span>)))
            <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>false</span>;
    <span style=color:#ff79c6>return</span> <span style=color:#8be9fd;font-style:italic>true</span>;
}

<span style=color:#8be9fd>int</span> <span style=color:#50fa7b>GetCount</span>(<span style=color:#8be9fd>int</span> state)
{
    <span style=color:#8be9fd>int</span> res <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>;
    <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> m; i<span style=color:#ff79c6>++</span>)
        <span style=color:#ff79c6>if</span> ((state <span style=color:#ff79c6>&gt;&gt;</span> i) <span style=color:#ff79c6>&amp;</span> <span style=color:#bd93f9>1</span>)
            res<span style=color:#ff79c6>++</span>;
    <span style=color:#ff79c6>return</span> res;
}

<span style=color:#8be9fd>int</span> <span style=color:#50fa7b>main</span>()
{
    std<span style=color:#ff79c6>::</span>cin <span style=color:#ff79c6>&gt;&gt;</span> n <span style=color:#ff79c6>&gt;&gt;</span> m;
    <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>; i <span style=color:#ff79c6>&lt;=</span> n; i<span style=color:#ff79c6>++</span>)
        <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> j <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; j <span style=color:#ff79c6>&lt;</span> m; j<span style=color:#ff79c6>++</span>)
        {
            <span style=color:#8be9fd>char</span> c;
            std<span style=color:#ff79c6>::</span>cin <span style=color:#ff79c6>&gt;&gt;</span> c;
            <span style=color:#ff79c6>if</span> (c <span style=color:#ff79c6>==</span> <span style=color:#f1fa8c>&#39;H&#39;</span>)
                g[i] <span style=color:#ff79c6>+=</span> <span style=color:#bd93f9>1</span> <span style=color:#ff79c6>&lt;&lt;</span> j;
        }
    
    <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;</span> (<span style=color:#bd93f9>1</span> <span style=color:#ff79c6>&lt;&lt;</span> m); i<span style=color:#ff79c6>++</span>)
        <span style=color:#ff79c6>if</span> (Check(i))
        {
            s.push_back(i);
            count[i] <span style=color:#ff79c6>=</span> GetCount(i);
        }
    
    <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>; i <span style=color:#ff79c6>&lt;=</span> n <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>2</span>; i<span style=color:#ff79c6>++</span>)
        <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> a <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; a <span style=color:#ff79c6>&lt;</span> s.size(); a<span style=color:#ff79c6>++</span>) <span style=color:#6272a4>// i
</span><span style=color:#6272a4></span>            <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> b <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; b <span style=color:#ff79c6>&lt;</span> s.size(); b<span style=color:#ff79c6>++</span>) <span style=color:#6272a4>// i - 1
</span><span style=color:#6272a4></span>                <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> c <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; c <span style=color:#ff79c6>&lt;</span> s.size(); c<span style=color:#ff79c6>++</span>) <span style=color:#6272a4>// i - 2
</span><span style=color:#6272a4></span>                {
                    <span style=color:#8be9fd>int</span> p <span style=color:#ff79c6>=</span> s[a], q <span style=color:#ff79c6>=</span> s[b], r <span style=color:#ff79c6>=</span> s[c];
                    <span style=color:#ff79c6>if</span> ((p <span style=color:#ff79c6>&amp;</span> q) <span style=color:#ff79c6>|</span> (q <span style=color:#ff79c6>&amp;</span> r) <span style=color:#ff79c6>|</span> (p <span style=color:#ff79c6>&amp;</span> r))
                        <span style=color:#ff79c6>continue</span>;
                    <span style=color:#ff79c6>if</span> ((g[i] <span style=color:#ff79c6>&amp;</span> p) <span style=color:#ff79c6>|</span> (g[i <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>] <span style=color:#ff79c6>&amp;</span> q))
                        <span style=color:#ff79c6>continue</span>;
                    f[i <span style=color:#ff79c6>&amp;</span> <span style=color:#bd93f9>1</span>][a][b] <span style=color:#ff79c6>=</span> std<span style=color:#ff79c6>::</span>max(f[i <span style=color:#ff79c6>&amp;</span> <span style=color:#bd93f9>1</span>][a][b], f[(i <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>) <span style=color:#ff79c6>&amp;</span> <span style=color:#bd93f9>1</span>][b][c] <span style=color:#ff79c6>+</span> count[p]);
                }
    
    std<span style=color:#ff79c6>::</span>cout <span style=color:#ff79c6>&lt;&lt;</span> f[(n <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>2</span>) <span style=color:#ff79c6>&amp;</span> <span style=color:#bd93f9>1</span>][<span style=color:#bd93f9>0</span>][<span style=color:#bd93f9>0</span>] <span style=color:#ff79c6>&lt;&lt;</span> std<span style=color:#ff79c6>::</span>endl;
    <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>0</span>;
}
</code></pre></td></tr></table></div></div><p><a href=https://www.luogu.com.cn/problem/P2831>洛谷-P831-[NOIP2016 提高组] 愤怒的小鸟</a></p><p>本题属于<strong>集合式的动态规划</strong>。</p><p>可以把一条抛物线覆盖的猪按猪的编号二进制压缩成一个数，用$f_{state}$表示达到这一状态的最少抛物线数量。由于本题中的抛物线一定过原点，所以只要找到另外两个点就可以确定一条抛物线，我们用$path_{i, j}$表示有一条抛物线经过$i$、$j$的覆盖情况。</p><p>处理完$path_{i, j}$后，我们枚举状态$state$并扫描它，找到第一个猪没有被覆盖的位置并标记，并用与它构成的$path$来更新$state$。转移方程如下：</p><p>$$
f_{state \lor path_{from, to}} = \min(f_{to} + 1)
$$</p><p>时间复杂度$O(T(n ^ 3 + 2 ^ n n))$。</p><div class=highlight><div style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">68
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">69
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">70
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">71
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">72
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">73
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">74
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">75
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">76
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">77
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">78
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">79
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">80
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">81
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">82
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">83
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">84
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#ff79c6>#include</span> <span style=color:#ff79c6>&lt;iostream&gt;</span><span style=color:#ff79c6>
</span><span style=color:#ff79c6>#include</span> <span style=color:#ff79c6>&lt;cmath&gt;</span><span style=color:#ff79c6>
</span><span style=color:#ff79c6>#include</span> <span style=color:#ff79c6>&lt;vector&gt;</span><span style=color:#ff79c6>
</span><span style=color:#ff79c6></span>
<span style=color:#ff79c6>const</span> <span style=color:#8be9fd>int</span> N <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>20</span>, M <span style=color:#ff79c6>=</span> (<span style=color:#bd93f9>1</span> <span style=color:#ff79c6>&lt;&lt;</span> <span style=color:#bd93f9>18</span>) <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>5</span>, PosInf <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1e9</span>;
<span style=color:#ff79c6>const</span> <span style=color:#8be9fd>double</span> EPS <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1e-6</span>;

<span style=color:#ff79c6>struct</span> <span style=color:#50fa7b>Pig</span>
{
    <span style=color:#8be9fd>double</span> x, y;
} pigs[N];

<span style=color:#8be9fd>int</span> n, m;
<span style=color:#8be9fd>int</span> f[M], path[N][N];

<span style=color:#8be9fd>int</span> <span style=color:#50fa7b>main</span>()
{
    <span style=color:#8be9fd>int</span> T;
    std<span style=color:#ff79c6>::</span>cin <span style=color:#ff79c6>&gt;&gt;</span> T;
    <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> test <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>; test <span style=color:#ff79c6>&lt;=</span> T; test<span style=color:#ff79c6>++</span>)
    {
        std<span style=color:#ff79c6>::</span>cin <span style=color:#ff79c6>&gt;&gt;</span> n <span style=color:#ff79c6>&gt;&gt;</span> m;
        <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>; i <span style=color:#ff79c6>&lt;=</span> n; i<span style=color:#ff79c6>++</span>)
            std<span style=color:#ff79c6>::</span>cin <span style=color:#ff79c6>&gt;&gt;</span> pigs[i].x <span style=color:#ff79c6>&gt;&gt;</span> pigs[i].y;

        <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>; i <span style=color:#ff79c6>&lt;=</span> (<span style=color:#bd93f9>1</span> <span style=color:#ff79c6>&lt;&lt;</span> n) <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>; i<span style=color:#ff79c6>++</span>)
            f[i] <span style=color:#ff79c6>=</span> PosInf;
        f[<span style=color:#bd93f9>0</span>] <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>;

        <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>; i <span style=color:#ff79c6>&lt;=</span> n; i<span style=color:#ff79c6>++</span>)
            <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> j <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>; j <span style=color:#ff79c6>&lt;=</span> n; j<span style=color:#ff79c6>++</span>)
            {
                path[i][j] <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>;
                <span style=color:#ff79c6>if</span> (i <span style=color:#ff79c6>==</span> j)
                {
                    path[i][j] <span style=color:#ff79c6>=</span> (<span style=color:#bd93f9>1</span> <span style=color:#ff79c6>&lt;&lt;</span> (i <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>));
                    <span style=color:#ff79c6>continue</span>;
                }

                Pig <span style=color:#ff79c6>&amp;</span>u <span style=color:#ff79c6>=</span> pigs[i];
                Pig <span style=color:#ff79c6>&amp;</span>v <span style=color:#ff79c6>=</span> pigs[j];
                <span style=color:#ff79c6>if</span> (fabs(u.x <span style=color:#ff79c6>-</span> v.x) <span style=color:#ff79c6>&lt;</span> EPS)
                    <span style=color:#ff79c6>continue</span>;

                <span style=color:#6272a4>// x1 * x1 * a + b * x1 = y1
</span><span style=color:#6272a4></span>                <span style=color:#6272a4>// x2 * x2 * a + b * x2 = y2
</span><span style=color:#6272a4></span>                <span style=color:#8be9fd>double</span> a <span style=color:#ff79c6>=</span> (u.y <span style=color:#ff79c6>*</span> v.x <span style=color:#ff79c6>-</span> v.y <span style=color:#ff79c6>*</span> u.x) <span style=color:#ff79c6>/</span> (u.x <span style=color:#ff79c6>*</span> u.x <span style=color:#ff79c6>*</span> v.x <span style=color:#ff79c6>-</span> v.x <span style=color:#ff79c6>*</span> v.x <span style=color:#ff79c6>*</span> u.x);
                <span style=color:#ff79c6>if</span> (fabs(a <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>0</span>) <span style=color:#ff79c6>&lt;</span> EPS <span style=color:#ff79c6>||</span> a <span style=color:#ff79c6>&gt;</span> <span style=color:#bd93f9>0</span>)
                    <span style=color:#ff79c6>continue</span>;
                <span style=color:#8be9fd>double</span> b <span style=color:#ff79c6>=</span> (u.y <span style=color:#ff79c6>-</span> a <span style=color:#ff79c6>*</span> u.x <span style=color:#ff79c6>*</span> u.x) <span style=color:#ff79c6>/</span> u.x;

                <span style=color:#8be9fd>int</span> state <span style=color:#ff79c6>=</span> (<span style=color:#bd93f9>1</span> <span style=color:#ff79c6>&lt;&lt;</span> (i <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>)) <span style=color:#ff79c6>|</span> (<span style=color:#bd93f9>1</span> <span style=color:#ff79c6>&lt;&lt;</span> (j <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>));

                <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> k <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>; k <span style=color:#ff79c6>&lt;=</span> n; k<span style=color:#ff79c6>++</span>)
                {
                    <span style=color:#ff79c6>if</span> (k <span style=color:#ff79c6>==</span> i <span style=color:#ff79c6>||</span> k <span style=color:#ff79c6>==</span> j)
                        <span style=color:#ff79c6>continue</span>;

                    Pig <span style=color:#ff79c6>&amp;</span>w <span style=color:#ff79c6>=</span> pigs[k];
                    <span style=color:#ff79c6>if</span> (fabs(a <span style=color:#ff79c6>*</span> w.x <span style=color:#ff79c6>*</span> w.x <span style=color:#ff79c6>+</span> b <span style=color:#ff79c6>*</span> w.x <span style=color:#ff79c6>-</span> w.y) <span style=color:#ff79c6>&lt;</span> EPS)
                        state <span style=color:#ff79c6>=</span> state <span style=color:#ff79c6>|</span> (<span style=color:#bd93f9>1</span> <span style=color:#ff79c6>&lt;&lt;</span> (k <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>));
                }

                path[i][j] <span style=color:#ff79c6>=</span> state;
            }

        <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> i <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>; i <span style=color:#ff79c6>&lt;=</span> (<span style=color:#bd93f9>1</span> <span style=color:#ff79c6>&lt;&lt;</span> n) <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>; i<span style=color:#ff79c6>++</span>)
        {
            <span style=color:#8be9fd>int</span> x <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>0</span>;
            <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> j <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>; j <span style=color:#ff79c6>&lt;=</span> n; j<span style=color:#ff79c6>++</span>)
                <span style=color:#ff79c6>if</span> (<span style=color:#ff79c6>!</span>((i <span style=color:#ff79c6>&gt;&gt;</span> (j <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>)) <span style=color:#ff79c6>&amp;</span> <span style=color:#bd93f9>1</span>))
                {
                    x <span style=color:#ff79c6>=</span> j;
                    <span style=color:#ff79c6>break</span>;
                }

            <span style=color:#ff79c6>for</span> (<span style=color:#8be9fd>int</span> j <span style=color:#ff79c6>=</span> <span style=color:#bd93f9>1</span>; j <span style=color:#ff79c6>&lt;=</span> n; j<span style=color:#ff79c6>++</span>)
                f[i <span style=color:#ff79c6>|</span> path[x][j]] <span style=color:#ff79c6>=</span> std<span style=color:#ff79c6>::</span>min(f[i <span style=color:#ff79c6>|</span> path[x][j]], f[i] <span style=color:#ff79c6>+</span> <span style=color:#bd93f9>1</span>);
        }

        std<span style=color:#ff79c6>::</span>cout <span style=color:#ff79c6>&lt;&lt;</span> f[(<span style=color:#bd93f9>1</span> <span style=color:#ff79c6>&lt;&lt;</span> n) <span style=color:#ff79c6>-</span> <span style=color:#bd93f9>1</span>] <span style=color:#ff79c6>&lt;&lt;</span> std<span style=color:#ff79c6>::</span>endl;
    }
    <span style=color:#ff79c6>return</span> <span style=color:#bd93f9>0</span>;
}
</code></pre></td></tr></table></div></div></div><div class=post-archive><ul class=post-copyright><li><strong>原文作者：</strong><a rel=author href=https://www.pigaunt.top>PigAunt</a></li><li style=word-break:break-all><strong>原文链接：</strong><a href=https://www.pigaunt.top/post/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E7%8A%B6%E6%80%81%E5%8E%8B%E7%BC%A9%E7%9A%84%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/>https://www.pigaunt.top/post/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E7%8A%B6%E6%80%81%E5%8E%8B%E7%BC%A9%E7%9A%84%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/</a></li><li><strong>版权声明：</strong>本作品采用<a rel=license href>知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可，非商业转载请注明出处（作者，原文链接）并按照相同协议共享，禁止商业转载。</li></ul></div><br><div class=post-archive><h2>See Also</h2><ul class=listing><li><a href=/post/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/LIS%E5%92%8CLCS/>LIS和LCS</a></li><li><a href=/post/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/>背包问题</a></li><li><a href=/post/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E7%8A%B6%E6%80%81%E6%9C%BA/>状态机</a></li><li><a href=/post/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E6%95%B0%E5%AD%97%E4%B8%89%E8%A7%92%E5%BD%A2/>数字三角形</a></li><li><a href=/post/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E5%8C%BA%E9%97%B4%E5%9E%8B%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/>区间型动态规划</a></li></ul></div><div class="post-meta meta-tags"><ul class=clearfix><li><a href=/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92>动态规划</a></li></ul></div></article></div><footer id=footer><div>&copy; 2021 <a href=https://www.pigaunt.top>PigAunt的博客 By PigAunt</a></div><br><div><div class=github-badge><a href=https://gohugo.io/ target=_black rel=nofollow><span class=badge-subject>Powered by</span><span class="badge-value bg-blue">Hugo</span></a></div><div class=github-badge><a href=https://www.flysnow.org/ target=_black><span class=badge-subject>Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a></div><div class=github-badge><a href=https://github.com/flysnow-org/maupassant-hugo target=_black><span class=badge-subject>Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a></div></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[['$','$']],processEscapes:!0}}</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script><a id=rocket href=#top></a><script type=text/javascript src="/js/totop.js?v=0.0.0" async></script><script type=text/javascript src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js async></script><script src=/js/douban.js></script></div><div id=secondary><section class=widget><form id=search action=https://www.pigaunt.top/search/ method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=Search>
<input type=hidden name=sitesearch value=https://www.pigaunt.top>
<button type=submit class="submit icon-search"></button></form></section><section class=widget><h3 class=widget-title>最近文章</h3><ul class=widget-list><li><a href=https://www.pigaunt.top/post/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E6%A0%91%E5%BD%A2%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/ title=树形动态规划>树形动态规划</a></li><li><a href=https://www.pigaunt.top/post/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E6%95%B0%E4%BD%8D%E5%9E%8B%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/ title=数位型动态规划>数位型动态规划</a></li><li><a href=https://www.pigaunt.top/post/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E7%8A%B6%E6%80%81%E5%8E%8B%E7%BC%A9%E7%9A%84%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/ title=状态压缩的动态规划>状态压缩的动态规划</a></li><li><a href=https://www.pigaunt.top/post/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E5%8D%95%E8%B0%83%E9%98%9F%E5%88%97/ title=单调队列>单调队列</a></li><li><a href=https://www.pigaunt.top/post/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/LIS%E5%92%8CLCS/ title=LIS和LCS>LIS和LCS</a></li><li><a href=https://www.pigaunt.top/post/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E5%8C%BA%E9%97%B4%E5%9E%8B%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/ title=区间型动态规划>区间型动态规划</a></li><li><a href=https://www.pigaunt.top/post/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E6%95%B0%E5%AD%97%E4%B8%89%E8%A7%92%E5%BD%A2/ title=数字三角形>数字三角形</a></li><li><a href=https://www.pigaunt.top/post/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E7%8A%B6%E6%80%81%E6%9C%BA/ title=状态机>状态机</a></li><li><a href=https://www.pigaunt.top/post/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/ title=背包问题>背包问题</a></li><li><a href=https://www.pigaunt.top/post/misc/hello-world/ title="Hello World">Hello World</a></li></ul></section><section class=widget><h3 class=widget-title><a href=/categories/>分类</a></h3><ul class=widget-list><li><a href=https://www.pigaunt.top/categories/misc/>misc (1)</a></li><li><a href=https://www.pigaunt.top/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/>动态规划 (8)</a></li><li><a href=https://www.pigaunt.top/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/>数据结构 (1)</a></li></ul></section><section class=widget><h3 class=widget-title><a href=/tags/>标签</a></h3><div class=tagcloud><a href=https://www.pigaunt.top/tags/misc/>misc</a>
<a href=https://www.pigaunt.top/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/>动态规划</a>
<a href=https://www.pigaunt.top/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/>数据结构</a></div></section><section class=widget><h3 class=widget-title>友情链接</h3><ul class=widget-list><li><a target=_blank href=https://rusun.blog.luogu.org/ title=RuSun的博客>RuSun的博客</a></li></ul></section><section class=widget><h3 class=widget-title>其它</h3><ul class=widget-list><li><a href=https://www.pigaunt.top/index.xml>文章 RSS</a></li></ul></section></div></div></div></div></body></html>