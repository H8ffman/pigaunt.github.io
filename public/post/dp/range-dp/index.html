<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="referrer" content="no-referrer-when-downgrade">
    

    <title>区间型动态规划 | PigAunt的博客</title>
    <meta property="og:title" content="区间型动态规划 - PigAunt的博客">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2021-08-11T10:50:50&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2021-08-11T10:50:50&#43;08:00'>
        
    <meta name="Keywords" content="C&#43;&#43;,OI,C#">
    <meta name="description" content="区间型动态规划">
        
    <meta name="author" content="PigAunt">
    <meta property="og:url" content="https://www.pigaunt.top/post/dp/range-dp/">
    <link rel="shortcut icon" href='/favicon.ico'  type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
        <link rel="stylesheet" href='/css/douban.css'>
    
        <link rel="stylesheet" href='/css/other.css'>
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://www.pigaunt.top">
                        PigAunt的博客
                    </a>
                
                <p class="description">Hello, World!</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="current" href="https://www.pigaunt.top">首页</a>
                    
                    <a  href="https://www.pigaunt.top/archives/" title="归档">归档</a>
                    
                    <a  href="https://www.pigaunt.top/about/" title="关于">关于</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    
    <article class="post">
        <header>
            <h1 class="post-title">区间型动态规划</h1>
        </header>
        <date class="post-meta meta-date">
            2021年8月11日
        </date>
        
        <div class="post-meta">
            <span>|</span>
            
            <span class="meta-category"><a href='/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92'>动态规划</a></span>
            
        </div>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            <h1 id="区间型动态规划">区间型动态规划</h1>
<h2 id="石子合并问题">石子合并问题</h2>
<p>有若干个石子排成一行，每个石子有一定的质量，现在要将它们合并成一堆，每一次合并产生的价值是两堆石子的质量和（只能合并相邻的石子），求最大/最小价值。</p>
<p>以最小值为例，对于这个问题，如果我们用$f_{i, j}$表示从$i$到$j$的代价最小值，那么这一块区域可以被分割成两个小的区域，通过不断调整分割点，我们就可以找到$f_{i, j}$，转移方程如下：
$$
f_{i, j} = \min(f_{i, j}, f_{i, k} + f_{k + 1, j} + s[j] - s[i - 1]) (i \le k &lt; j)
$$
初始值：
$$
f_{i, i} = 0
$$
时间复杂度$O(n ^ 3)$。</p>
<p>如果石子排成了一个环呢？</p>
<h2 id="环形石子合并问题">环形石子合并问题</h2>
<p>一般来说，有下面几种转换方法：</p>
<ol>
<li>把环变成链，枚举那个缺口，时间复杂度$O(n ^ 4)$；</li>
<li>考虑到变成环之后，问题转换为求$n$条链上的石子合并问题，那么可以把长度为$n$的链拆开，复制一次，变成长度为$2n$的链，用石子合并的方法求出$f_{i, j}$后，求出$\min(f_{i, i + n - 1})$，时间复杂度$O(8n ^ 3)$；</li>
</ol>
<p>显然第二种更好。</p>
<p><a href="https://www.luogu.com.cn/problem/P1880">洛谷-P1880-[NOI1995] 石子合并</a></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;iostream&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6"></span>
<span style="color:#ff79c6">const</span> <span style="color:#8be9fd">int</span> N <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">205</span>, PosInf <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1e9</span>;

<span style="color:#8be9fd">int</span> n;
<span style="color:#8be9fd">int</span> a[N], s[N], f[N][N], g[N][N];

<span style="color:#8be9fd">int</span> <span style="color:#50fa7b">main</span>()
{
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>; i <span style="color:#ff79c6">&lt;</span> N; i<span style="color:#ff79c6">++</span>)
        <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> j <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>; j <span style="color:#ff79c6">&lt;</span> N; j<span style="color:#ff79c6">++</span>)
        {
            <span style="color:#ff79c6">if</span> (i <span style="color:#ff79c6">==</span> j)
                f[i][i] <span style="color:#ff79c6">=</span> g[i][i] <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>;
            <span style="color:#ff79c6">else</span>
            {
                f[i][j] <span style="color:#ff79c6">=</span> PosInf;
                g[i][j] <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">-</span>PosInf;
            }
        }

    std<span style="color:#ff79c6">::</span>cin <span style="color:#ff79c6">&gt;&gt;</span> n;
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; i <span style="color:#ff79c6">&lt;=</span> n; i<span style="color:#ff79c6">++</span>)
    {
        std<span style="color:#ff79c6">::</span>cin <span style="color:#ff79c6">&gt;&gt;</span> a[i];
        a[i <span style="color:#ff79c6">+</span> n] <span style="color:#ff79c6">=</span> a[i];
    }
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; i <span style="color:#ff79c6">&lt;=</span> n <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">2</span>; i<span style="color:#ff79c6">++</span>)
        s[i] <span style="color:#ff79c6">=</span> s[i <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>] <span style="color:#ff79c6">+</span> a[i];

    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> len <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; len <span style="color:#ff79c6">&lt;=</span> n; len<span style="color:#ff79c6">++</span>)
        <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> l <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; l <span style="color:#ff79c6">+</span> len <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span> <span style="color:#ff79c6">&lt;=</span> n <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">2</span>; l<span style="color:#ff79c6">++</span>)
        {
            <span style="color:#8be9fd">int</span> r <span style="color:#ff79c6">=</span> l <span style="color:#ff79c6">+</span> len <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>;
            <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> k <span style="color:#ff79c6">=</span> l; k <span style="color:#ff79c6">&lt;</span> r; k<span style="color:#ff79c6">++</span>)
            {
                f[l][r] <span style="color:#ff79c6">=</span> std<span style="color:#ff79c6">::</span>min(f[l][r], f[l][k] <span style="color:#ff79c6">+</span> f[k <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>][r] <span style="color:#ff79c6">+</span> s[r] <span style="color:#ff79c6">-</span> s[l <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>]);
                g[l][r] <span style="color:#ff79c6">=</span> std<span style="color:#ff79c6">::</span>max(g[l][r], g[l][k] <span style="color:#ff79c6">+</span> g[k <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>][r] <span style="color:#ff79c6">+</span> s[r] <span style="color:#ff79c6">-</span> s[l <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>]);
            }
        }

    <span style="color:#8be9fd">int</span> wMin <span style="color:#ff79c6">=</span> PosInf, wMax <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">-</span>PosInf;
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> l <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; l <span style="color:#ff79c6">&lt;=</span> n; l<span style="color:#ff79c6">++</span>)
    {
        wMin <span style="color:#ff79c6">=</span> std<span style="color:#ff79c6">::</span>min(wMin, f[l][l <span style="color:#ff79c6">+</span> n <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>]);
        wMax <span style="color:#ff79c6">=</span> std<span style="color:#ff79c6">::</span>max(wMax, g[l][l <span style="color:#ff79c6">+</span> n <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>]);
    }
    std<span style="color:#ff79c6">::</span>cout <span style="color:#ff79c6">&lt;&lt;</span> wMin <span style="color:#ff79c6">&lt;&lt;</span> std<span style="color:#ff79c6">::</span>endl;
    std<span style="color:#ff79c6">::</span>cout <span style="color:#ff79c6">&lt;&lt;</span> wMax <span style="color:#ff79c6">&lt;&lt;</span> std<span style="color:#ff79c6">::</span>endl;
    <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">0</span>;
}
</code></pre></td></tr></table>
</div>
</div><h3 id="问题拓展">问题拓展</h3>
<p><a href="https://www.acwing.com/problem/content/322/">AcWing-320-能量项链</a></p>
<p>本题和前面的合并略有不同，待合并的两个区间不是由点构成，而是由点与点之间的空隙构成。因此区间长度至少是3，至多是$n + 1$，且断点$k$不能和左端点相等。</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;iostream&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6"></span>
<span style="color:#ff79c6">const</span> <span style="color:#8be9fd">int</span> N <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">205</span>, PosInf <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1e9</span>;

<span style="color:#8be9fd">int</span> n;
<span style="color:#8be9fd">int</span> a[N], f[N][N];

<span style="color:#8be9fd">int</span> <span style="color:#50fa7b">main</span>()
{
    std<span style="color:#ff79c6">::</span>cin <span style="color:#ff79c6">&gt;&gt;</span> n;
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; i <span style="color:#ff79c6">&lt;=</span> n; i<span style="color:#ff79c6">++</span>)
    {
        std<span style="color:#ff79c6">::</span>cin <span style="color:#ff79c6">&gt;&gt;</span> a[i];
        a[i <span style="color:#ff79c6">+</span> n] <span style="color:#ff79c6">=</span> a[i];
    }

    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> len <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">3</span>; len <span style="color:#ff79c6">&lt;=</span> n <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>; len<span style="color:#ff79c6">++</span>)
        <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> l <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; l <span style="color:#ff79c6">+</span> len <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span> <span style="color:#ff79c6">&lt;=</span> n <span style="color:#ff79c6">*</span> <span style="color:#bd93f9">2</span>; l<span style="color:#ff79c6">++</span>)
        {
            <span style="color:#8be9fd">int</span> r <span style="color:#ff79c6">=</span> l <span style="color:#ff79c6">+</span> len <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>;
            <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> k <span style="color:#ff79c6">=</span> l <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>; k <span style="color:#ff79c6">&lt;</span> r; k<span style="color:#ff79c6">++</span>)
                f[l][r] <span style="color:#ff79c6">=</span> std<span style="color:#ff79c6">::</span>max(f[l][r], f[l][k] <span style="color:#ff79c6">+</span> f[k][r] <span style="color:#ff79c6">+</span> a[l] <span style="color:#ff79c6">*</span> a[k] <span style="color:#ff79c6">*</span> a[r]);
        }

    <span style="color:#8be9fd">int</span> wMax <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">-</span>PosInf;
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> l <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; l <span style="color:#ff79c6">&lt;=</span> n; l<span style="color:#ff79c6">++</span>)
        wMax <span style="color:#ff79c6">=</span> std<span style="color:#ff79c6">::</span>max(wMax, f[l][l <span style="color:#ff79c6">+</span> n]);
    std<span style="color:#ff79c6">::</span>cout <span style="color:#ff79c6">&lt;&lt;</span> wMax <span style="color:#ff79c6">&lt;&lt;</span> std<span style="color:#ff79c6">::</span>endl;
    <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">0</span>;
}
</code></pre></td></tr></table>
</div>
</div><p><a href="https://loj.ac/p/10149">LibreOJ-10149-凸多边形的划分</a></p>
<p>可以将一个多边形的划分拆为三部分：左，中（三角形），右。最小价值即为这三者的价值和，于是可以发现转移方程和能量项链类似：
$$
f_{i, j} = \min(f_{i, j}, f_{i, k} + f{k, j} + w_i w_k w_j)
$$
注意，本题数据较大，需要做高精度。</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;iostream&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;cstring&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6"></span>
<span style="color:#ff79c6">const</span> <span style="color:#8be9fd">int</span> N <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">55</span>, M <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">35</span>, PosInf <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1e9</span>;

<span style="color:#8be9fd">int</span> n, w[N];
<span style="color:#8be9fd">long</span> <span style="color:#8be9fd">long</span> f[N][N][M];

<span style="color:#8be9fd">void</span> <span style="color:#50fa7b">Add</span>(<span style="color:#8be9fd">long</span> <span style="color:#8be9fd">long</span> a[], <span style="color:#8be9fd">long</span> <span style="color:#8be9fd">long</span> b[])
{
    <span style="color:#ff79c6">static</span> <span style="color:#8be9fd">long</span> <span style="color:#8be9fd">long</span> c[M];
    memset(c, <span style="color:#bd93f9">0</span>, <span style="color:#ff79c6">sizeof</span>(c));
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>, t <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>; i <span style="color:#ff79c6">&lt;</span> M; i<span style="color:#ff79c6">++</span>)
    {
        t <span style="color:#ff79c6">+=</span> a[i] <span style="color:#ff79c6">+</span> b[i];
        c[i] <span style="color:#ff79c6">=</span> t <span style="color:#ff79c6">%</span> <span style="color:#bd93f9">10</span>;
        t <span style="color:#ff79c6">/=</span> <span style="color:#bd93f9">10</span>;
    }
    memcpy(a, c, <span style="color:#ff79c6">sizeof</span>(c));
}

<span style="color:#8be9fd">void</span> <span style="color:#50fa7b">Mul</span>(<span style="color:#8be9fd">long</span> <span style="color:#8be9fd">long</span> a[], <span style="color:#8be9fd">long</span> <span style="color:#8be9fd">long</span> b)
{
    <span style="color:#ff79c6">static</span> <span style="color:#8be9fd">long</span> <span style="color:#8be9fd">long</span> c[M];
    memset(c, <span style="color:#bd93f9">0</span>, <span style="color:#ff79c6">sizeof</span>(c));
    <span style="color:#8be9fd">long</span> <span style="color:#8be9fd">long</span> t <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>;
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>; i <span style="color:#ff79c6">&lt;</span> M; i<span style="color:#ff79c6">++</span>)
    {
        t <span style="color:#ff79c6">+=</span> a[i] <span style="color:#ff79c6">*</span> b;
        c[i] <span style="color:#ff79c6">=</span> t <span style="color:#ff79c6">%</span> <span style="color:#bd93f9">10</span>;
        t <span style="color:#ff79c6">/=</span> <span style="color:#bd93f9">10</span>;
    }
    memcpy(a, c, <span style="color:#ff79c6">sizeof</span>(c));
}

<span style="color:#8be9fd">int</span> <span style="color:#50fa7b">Comp</span>(<span style="color:#8be9fd">long</span> <span style="color:#8be9fd">long</span> a[], <span style="color:#8be9fd">long</span> <span style="color:#8be9fd">long</span> b[])
{
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> M <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>; i <span style="color:#ff79c6">&gt;=</span> <span style="color:#bd93f9">0</span>; i<span style="color:#ff79c6">--</span>)
        <span style="color:#ff79c6">if</span> (a[i] <span style="color:#ff79c6">&gt;</span> b[i])
            <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">1</span>;
        <span style="color:#ff79c6">else</span> <span style="color:#ff79c6">if</span> (a[i] <span style="color:#ff79c6">&lt;</span> b[i])
            <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>;
    <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">0</span>;
}

<span style="color:#8be9fd">int</span> <span style="color:#50fa7b">main</span>()
{
    std<span style="color:#ff79c6">::</span>cin <span style="color:#ff79c6">&gt;&gt;</span> n;
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; i <span style="color:#ff79c6">&lt;=</span> n; i<span style="color:#ff79c6">++</span>)
        std<span style="color:#ff79c6">::</span>cin <span style="color:#ff79c6">&gt;&gt;</span> w[i];

    <span style="color:#8be9fd">long</span> <span style="color:#8be9fd">long</span> temp[M];
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> len <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">3</span>; len <span style="color:#ff79c6">&lt;=</span> n <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>; len<span style="color:#ff79c6">++</span>)
        <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> l <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; l <span style="color:#ff79c6">+</span> len <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span> <span style="color:#ff79c6">&lt;=</span> n; l<span style="color:#ff79c6">++</span>)
        {
            <span style="color:#8be9fd">int</span> r <span style="color:#ff79c6">=</span> l <span style="color:#ff79c6">+</span> len <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>;
            f[l][r][M <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>] <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>;
            <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> k <span style="color:#ff79c6">=</span> l <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>; k <span style="color:#ff79c6">&lt;</span> r; k<span style="color:#ff79c6">++</span>)
            {
                memset(temp, <span style="color:#bd93f9">0</span>, <span style="color:#ff79c6">sizeof</span>(temp));
                temp[<span style="color:#bd93f9">0</span>] <span style="color:#ff79c6">=</span> w[l];
                Mul(temp, w[k]);
                Mul(temp, w[r]);
                Add(temp, f[l][k]);
                Add(temp, f[k][r]);
                <span style="color:#ff79c6">if</span> (Comp(f[l][r], temp) <span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">0</span>)
                    memcpy(f[l][r], temp, <span style="color:#ff79c6">sizeof</span>(temp));
            }
        }

    <span style="color:#8be9fd">int</span> k <span style="color:#ff79c6">=</span> M <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>;
    <span style="color:#ff79c6">while</span> (k <span style="color:#ff79c6">&gt;</span> <span style="color:#bd93f9">0</span> <span style="color:#ff79c6">&amp;&amp;</span> f[<span style="color:#bd93f9">1</span>][n][k] <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">0</span>)
        k<span style="color:#ff79c6">--</span>;
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> k; i <span style="color:#ff79c6">&gt;=</span> <span style="color:#bd93f9">0</span>; i<span style="color:#ff79c6">--</span>)
        std<span style="color:#ff79c6">::</span>cout <span style="color:#ff79c6">&lt;&lt;</span> f[<span style="color:#bd93f9">1</span>][n][i];
    std<span style="color:#ff79c6">::</span>cout <span style="color:#ff79c6">&lt;&lt;</span> std<span style="color:#ff79c6">::</span>endl;
    <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">0</span>;
}
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.acwing.com/problem/content/481/">AcWing-479-加分二叉树</a></p>
<p>这个题乍一看似乎和动态规划没有关系，但我们仔细分析“中序”，可以发现，正如区间中用点分割，中序遍历中，左右子树和根正好可以通过区间型动态规划的经典处理方式划分。因此用$f_{i, j}$表示中序遍历为输入数组的$i$到$j$位的二叉树中加分的最大值，但由于要输出具体方案，还要用$g_{i, j}$表示中序遍历为输入数组的$i$到$j$位的二叉树的根的序号。</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;iostream&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6"></span>
<span style="color:#ff79c6">const</span> <span style="color:#8be9fd">int</span> N <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">35</span>;

<span style="color:#8be9fd">int</span> n, w[N];
<span style="color:#8be9fd">int</span> f[N][N], g[N][N];

<span style="color:#8be9fd">void</span> <span style="color:#50fa7b">Print</span>(<span style="color:#8be9fd">int</span> l, <span style="color:#8be9fd">int</span> r)
{
    <span style="color:#ff79c6">if</span> (l <span style="color:#ff79c6">&gt;</span> r)
        <span style="color:#ff79c6">return</span>;

    <span style="color:#8be9fd">int</span> root <span style="color:#ff79c6">=</span> g[l][r];
    std<span style="color:#ff79c6">::</span>cout <span style="color:#ff79c6">&lt;&lt;</span> root <span style="color:#ff79c6">&lt;&lt;</span> <span style="color:#f1fa8c">&#34; &#34;</span>;
    Print(l, root <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>);
    Print(root <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>, r);
}

<span style="color:#8be9fd">int</span> <span style="color:#50fa7b">main</span>()
{
    std<span style="color:#ff79c6">::</span>cin <span style="color:#ff79c6">&gt;&gt;</span> n;
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; i <span style="color:#ff79c6">&lt;=</span> n; i<span style="color:#ff79c6">++</span>)
        std<span style="color:#ff79c6">::</span>cin <span style="color:#ff79c6">&gt;&gt;</span> w[i];

    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> len <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; len <span style="color:#ff79c6">&lt;=</span> n; len<span style="color:#ff79c6">++</span>)
        <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> l <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; l <span style="color:#ff79c6">+</span> len <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span> <span style="color:#ff79c6">&lt;=</span> n; l<span style="color:#ff79c6">++</span>)
        {
            <span style="color:#8be9fd">int</span> r <span style="color:#ff79c6">=</span> l <span style="color:#ff79c6">+</span> len <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>;
            <span style="color:#ff79c6">if</span> (len <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">1</span>)
            {
                f[l][r] <span style="color:#ff79c6">=</span> w[l];
                g[l][r] <span style="color:#ff79c6">=</span> l;
            }
            <span style="color:#ff79c6">else</span>
            {
                <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> k <span style="color:#ff79c6">=</span> l; k <span style="color:#ff79c6">&lt;=</span> r; k<span style="color:#ff79c6">++</span>)
                {
                    <span style="color:#8be9fd">int</span> subl <span style="color:#ff79c6">=</span> (k <span style="color:#ff79c6">==</span> l) <span style="color:#ff79c6">?</span> <span style="color:#bd93f9">1</span> <span style="color:#ff79c6">:</span> f[l][k <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>];
                    <span style="color:#8be9fd">int</span> subr <span style="color:#ff79c6">=</span> (k <span style="color:#ff79c6">==</span> r) <span style="color:#ff79c6">?</span> <span style="color:#bd93f9">1</span> <span style="color:#ff79c6">:</span> f[k <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>][r];
                    <span style="color:#8be9fd">int</span> score <span style="color:#ff79c6">=</span> subl <span style="color:#ff79c6">*</span> subr <span style="color:#ff79c6">+</span> w[k];
                    <span style="color:#ff79c6">if</span> (f[l][r] <span style="color:#ff79c6">&lt;</span> score)
                    {
                        f[l][r] <span style="color:#ff79c6">=</span> score;
                        g[l][r] <span style="color:#ff79c6">=</span> k;
                    }
                }
            }
        }

    std<span style="color:#ff79c6">::</span>cout <span style="color:#ff79c6">&lt;&lt;</span> f[<span style="color:#bd93f9">1</span>][n] <span style="color:#ff79c6">&lt;&lt;</span> std<span style="color:#ff79c6">::</span>endl;
    Print(<span style="color:#bd93f9">1</span>, n);
    <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">0</span>;
}
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.acwing.com/problem/content/323/">AcWing-321-棋盘分割</a></p>
<p>本题的划分分为横向和纵向，同时区间也由一维扩展到了二维，因此实现时可以用记忆化搜索的方式减少代码量。用$f_{x1, y1, x2, y2, k}$表示$(x1, y1)$到$(x2, y2)$这个二维区间分割$k$次的最小均方差，那么这个区间可以横向或纵向划分，且可以任意选取划分后的两个子区间，按照这个逻辑，可以写出下面的代码：</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;iostream&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;iomanip&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;cmath&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;cstring&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6"></span>
<span style="color:#ff79c6">const</span> <span style="color:#8be9fd">int</span> m <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">8</span>, M <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">9</span>, N <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">20</span>, PosInf <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1e9</span>;

<span style="color:#8be9fd">int</span> n, s[M][M];
<span style="color:#8be9fd">double</span> f[M][M][M][M][N];
<span style="color:#8be9fd">double</span> average;

<span style="color:#8be9fd">double</span> <span style="color:#50fa7b">Calc</span>(<span style="color:#8be9fd">int</span> x1, <span style="color:#8be9fd">int</span> y1, <span style="color:#8be9fd">int</span> x2, <span style="color:#8be9fd">int</span> y2)
{
    <span style="color:#8be9fd">double</span> sum <span style="color:#ff79c6">=</span> s[x2][y2] <span style="color:#ff79c6">-</span> s[x2][y1 <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>] <span style="color:#ff79c6">-</span> s[x1 <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>][y2] <span style="color:#ff79c6">+</span> s[x1 <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>][y1 <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>];
    <span style="color:#ff79c6">return</span> (sum <span style="color:#ff79c6">-</span> average) <span style="color:#ff79c6">*</span> (sum <span style="color:#ff79c6">-</span> average) <span style="color:#ff79c6">/</span> n;
}

<span style="color:#8be9fd">double</span> <span style="color:#50fa7b">Search</span>(<span style="color:#8be9fd">int</span> x1, <span style="color:#8be9fd">int</span> y1, <span style="color:#8be9fd">int</span> x2, <span style="color:#8be9fd">int</span> y2, <span style="color:#8be9fd">int</span> k)
{
    <span style="color:#8be9fd">double</span> <span style="color:#ff79c6">&amp;</span>v <span style="color:#ff79c6">=</span> f[x1][y1][x2][y2][k];
    <span style="color:#ff79c6">if</span> (v <span style="color:#ff79c6">&gt;=</span> <span style="color:#bd93f9">0</span>)
        <span style="color:#ff79c6">return</span> v;
    <span style="color:#ff79c6">if</span> (k <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">1</span>)
        <span style="color:#ff79c6">return</span> v <span style="color:#ff79c6">=</span> Calc(x1, y1, x2, y2);

    v <span style="color:#ff79c6">=</span> PosInf;
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> x1; i <span style="color:#ff79c6">&lt;</span> x2; i<span style="color:#ff79c6">++</span>)
    {
        v <span style="color:#ff79c6">=</span> std<span style="color:#ff79c6">::</span>min(v, Search(x1, y1, i, y2, k <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>) <span style="color:#ff79c6">+</span> Calc(i <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>, y1, x2, y2));
        v <span style="color:#ff79c6">=</span> std<span style="color:#ff79c6">::</span>min(v, Search(i <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>, y1, x2, y2, k <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>) <span style="color:#ff79c6">+</span> Calc(x1, y1, i, y2));
    }
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> y1; i <span style="color:#ff79c6">&lt;</span> y2; i<span style="color:#ff79c6">++</span>)
    {
        v <span style="color:#ff79c6">=</span> std<span style="color:#ff79c6">::</span>min(v, Search(x1, y1, x2, i, k <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>) <span style="color:#ff79c6">+</span> Calc(x1, i <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>, x2, y2));
        v <span style="color:#ff79c6">=</span> std<span style="color:#ff79c6">::</span>min(v, Search(x1, i <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>, x2, y2, k <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>) <span style="color:#ff79c6">+</span> Calc(x1, y1, x2, i));
    }

    <span style="color:#ff79c6">return</span> v;
}

<span style="color:#8be9fd">int</span> <span style="color:#50fa7b">main</span>()
{
    std<span style="color:#ff79c6">::</span>cin <span style="color:#ff79c6">&gt;&gt;</span> n;
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; i <span style="color:#ff79c6">&lt;=</span> m; i<span style="color:#ff79c6">++</span>)
        <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> j <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; j <span style="color:#ff79c6">&lt;=</span> m; j<span style="color:#ff79c6">++</span>)
        {
            std<span style="color:#ff79c6">::</span>cin <span style="color:#ff79c6">&gt;&gt;</span> s[i][j];
            s[i][j] <span style="color:#ff79c6">+=</span> s[i <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>][j] <span style="color:#ff79c6">+</span> s[i][j <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>] <span style="color:#ff79c6">-</span> s[i <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>][j <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>];
        }

    memset(f, <span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>, <span style="color:#ff79c6">sizeof</span>(f));
    average <span style="color:#ff79c6">=</span> (<span style="color:#8be9fd">double</span>)s[m][m] <span style="color:#ff79c6">/</span> n;

    std<span style="color:#ff79c6">::</span>cout <span style="color:#ff79c6">&lt;&lt;</span> std<span style="color:#ff79c6">::</span>fixed <span style="color:#ff79c6">&lt;&lt;</span> std<span style="color:#ff79c6">::</span>setprecision(<span style="color:#bd93f9">3</span>) <span style="color:#ff79c6">&lt;&lt;</span> sqrt(Search(<span style="color:#bd93f9">1</span>, <span style="color:#bd93f9">1</span>, <span style="color:#bd93f9">8</span>, <span style="color:#bd93f9">8</span>, n)) <span style="color:#ff79c6">&lt;&lt;</span> std<span style="color:#ff79c6">::</span>endl;
    <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">0</span>;
}
</code></pre></td></tr></table>
</div>
</div><p><a href="https://www.luogu.com.cn/problem/P1436">洛谷-P1436-棋盘分割</a></p>
<p>这个跟上面一题其实是一样的，经过数学推导，上题求均方差，也就是求平方和，但均方差可以直接求。</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;iostream&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;cstring&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6"></span>
<span style="color:#ff79c6">const</span> <span style="color:#8be9fd">int</span> m <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">8</span>, M <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">9</span>, N <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">20</span>, PosInf <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1e9</span>;

<span style="color:#8be9fd">int</span> n, s[M][M];
<span style="color:#8be9fd">double</span> f[M][M][M][M][N];

<span style="color:#8be9fd">int</span> <span style="color:#50fa7b">Calc</span>(<span style="color:#8be9fd">int</span> x1, <span style="color:#8be9fd">int</span> y1, <span style="color:#8be9fd">int</span> x2, <span style="color:#8be9fd">int</span> y2)
{
    <span style="color:#8be9fd">double</span> sum <span style="color:#ff79c6">=</span> s[x2][y2] <span style="color:#ff79c6">-</span> s[x2][y1 <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>] <span style="color:#ff79c6">-</span> s[x1 <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>][y2] <span style="color:#ff79c6">+</span> s[x1 <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>][y1 <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>];
    <span style="color:#ff79c6">return</span> sum <span style="color:#ff79c6">*</span> sum;
}

<span style="color:#8be9fd">double</span> <span style="color:#50fa7b">Search</span>(<span style="color:#8be9fd">int</span> x1, <span style="color:#8be9fd">int</span> y1, <span style="color:#8be9fd">int</span> x2, <span style="color:#8be9fd">int</span> y2, <span style="color:#8be9fd">int</span> k)
{
    <span style="color:#8be9fd">double</span> <span style="color:#ff79c6">&amp;</span>v <span style="color:#ff79c6">=</span> f[x1][y1][x2][y2][k];
    <span style="color:#ff79c6">if</span> (v <span style="color:#ff79c6">&gt;=</span> <span style="color:#bd93f9">0</span>)
        <span style="color:#ff79c6">return</span> v;
    <span style="color:#ff79c6">if</span> (k <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">1</span>)
        <span style="color:#ff79c6">return</span> v <span style="color:#ff79c6">=</span> Calc(x1, y1, x2, y2);

    v <span style="color:#ff79c6">=</span> PosInf;
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> x1; i <span style="color:#ff79c6">&lt;</span> x2; i<span style="color:#ff79c6">++</span>)
    {
        v <span style="color:#ff79c6">=</span> std<span style="color:#ff79c6">::</span>min(v, Search(x1, y1, i, y2, k <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>) <span style="color:#ff79c6">+</span> Calc(i <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>, y1, x2, y2));
        v <span style="color:#ff79c6">=</span> std<span style="color:#ff79c6">::</span>min(v, Search(i <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>, y1, x2, y2, k <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>) <span style="color:#ff79c6">+</span> Calc(x1, y1, i, y2));
    }
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> y1; i <span style="color:#ff79c6">&lt;</span> y2; i<span style="color:#ff79c6">++</span>)
    {
        v <span style="color:#ff79c6">=</span> std<span style="color:#ff79c6">::</span>min(v, Search(x1, y1, x2, i, k <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>) <span style="color:#ff79c6">+</span> Calc(x1, i <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>, x2, y2));
        v <span style="color:#ff79c6">=</span> std<span style="color:#ff79c6">::</span>min(v, Search(x1, i <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>, x2, y2, k <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>) <span style="color:#ff79c6">+</span> Calc(x1, y1, x2, i));
    }

    <span style="color:#ff79c6">return</span> v;
}

<span style="color:#8be9fd">int</span> <span style="color:#50fa7b">main</span>()
{
    std<span style="color:#ff79c6">::</span>cin <span style="color:#ff79c6">&gt;&gt;</span> n;
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; i <span style="color:#ff79c6">&lt;=</span> m; i<span style="color:#ff79c6">++</span>)
        <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> j <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; j <span style="color:#ff79c6">&lt;=</span> m; j<span style="color:#ff79c6">++</span>)
        {
            std<span style="color:#ff79c6">::</span>cin <span style="color:#ff79c6">&gt;&gt;</span> s[i][j];
            s[i][j] <span style="color:#ff79c6">+=</span> s[i <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>][j] <span style="color:#ff79c6">+</span> s[i][j <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>] <span style="color:#ff79c6">-</span> s[i <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>][j <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>];
        }

    memset(f, <span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>, <span style="color:#ff79c6">sizeof</span>(f));

    std<span style="color:#ff79c6">::</span>cout <span style="color:#ff79c6">&lt;&lt;</span> Search(<span style="color:#bd93f9">1</span>, <span style="color:#bd93f9">1</span>, <span style="color:#bd93f9">8</span>, <span style="color:#bd93f9">8</span>, n) <span style="color:#ff79c6">&lt;&lt;</span> std<span style="color:#ff79c6">::</span>endl;
    <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">0</span>;
}
</code></pre></td></tr></table>
</div>
</div><h2 id="区间型动态规划的两种实现方式">区间型动态规划的两种实现方式</h2>
<h3 id="迭代式推荐">迭代式（推荐）</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> len <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; len <span style="color:#ff79c6">&lt;=</span> n; len<span style="color:#ff79c6">++</span>)
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> l <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>; l <span style="color:#ff79c6">+</span> len <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span> <span style="color:#ff79c6">&lt;=</span> n; l<span style="color:#ff79c6">++</span>)
    {
        r <span style="color:#ff79c6">=</span> l <span style="color:#ff79c6">+</span> len <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>;
        <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> k <span style="color:#ff79c6">=</span> l; k <span style="color:#ff79c6">&lt;</span> r; k<span style="color:#ff79c6">++</span>)
            <span style="color:#6272a4">// do something
</span><span style="color:#6272a4"></span>    }
</code></pre></td></tr></table>
</div>
</div><h3 id="记忆化搜索式适合状态定义较为复杂的情况">记忆化搜索式（适合状态定义较为复杂的情况）</h3>
<p>如果状态定义中数组维数太多，需要些很多重循环，这时可以用记忆化搜索的形式来写。</p>

        </div>

        
<div class="post-archive">
    <ul class="post-copyright">
        <li><strong>原文作者：</strong><a rel="author" href="https://www.pigaunt.top">PigAunt</a></li>
        <li style="word-break:break-all"><strong>原文链接：</strong><a href="https://www.pigaunt.top/post/dp/range-dp/">https://www.pigaunt.top/post/dp/range-dp/</a></li>
        <li><strong>版权声明：</strong>本作品采用<a rel="license" href="">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可，非商业转载请注明出处（作者，原文链接）并按照相同协议共享，禁止商业转载。</li>
    </ul>
</div>
<br/>



        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/post/dp/lis-and-lcs-problem/">LIS和LCS</a></li>
        
        <li><a href="/post/dp/number-triangle/">数字三角形</a></li>
        
        <li><a href="/post/dp/dfa/">状态机</a></li>
        
        <li><a href="/post/dp/pack-dp/">背包问题</a></li>
        
        <li><a href="/post/misc/hello-world/">Hello World</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92'>动态规划</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2022 <a href="https://www.pigaunt.top">PigAunt的博客 By PigAunt</a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">飞雪无情</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




    <script src='/js/douban.js'></script>

                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://www.pigaunt.top/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://www.pigaunt.top">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://www.pigaunt.top/post/math/seq-limit/" title="数列极限">数列极限</a>
    </li>
    
    <li>
        <a href="https://www.pigaunt.top/post/string/z-algorithm/" title="Z 函数及其求法（扩展 KMP）">Z 函数及其求法（扩展 KMP）</a>
    </li>
    
    <li>
        <a href="https://www.pigaunt.top/post/string/palindrome-and-manacher-algorithm/" title="回文字符串和 Manacher 算法">回文字符串和 Manacher 算法</a>
    </li>
    
    <li>
        <a href="https://www.pigaunt.top/post/dp/tree-dp/" title="树形动态规划">树形动态规划</a>
    </li>
    
    <li>
        <a href="https://www.pigaunt.top/post/dp/dp-on-numbers/" title="数位型动态规划">数位型动态规划</a>
    </li>
    
    <li>
        <a href="https://www.pigaunt.top/post/dp/state-compressed-dp/" title="状态压缩的动态规划">状态压缩的动态规划</a>
    </li>
    
    <li>
        <a href="https://www.pigaunt.top/post/data-structure/monotonous-queue/" title="单调队列">单调队列</a>
    </li>
    
    <li>
        <a href="https://www.pigaunt.top/post/dp/lis-and-lcs-problem/" title="LIS和LCS">LIS和LCS</a>
    </li>
    
    <li>
        <a href="https://www.pigaunt.top/post/dp/range-dp/" title="区间型动态规划">区间型动态规划</a>
    </li>
    
    <li>
        <a href="https://www.pigaunt.top/post/dp/number-triangle/" title="数字三角形">数字三角形</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href='/categories/'>分类</a></h3>
<ul class="widget-list">
    
    <li><a href="https://www.pigaunt.top/categories/misc/">misc (1)</a></li>
    
    <li><a href="https://www.pigaunt.top/categories/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划 (10)</a></li>
    
    <li><a href="https://www.pigaunt.top/categories/%E5%AD%97%E7%AC%A6%E4%B8%B2/">字符串 (2)</a></li>
    
    <li><a href="https://www.pigaunt.top/categories/%E6%95%B0%E5%AD%A6/">数学 (1)</a></li>
    
    <li><a href="https://www.pigaunt.top/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构 (1)</a></li>
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href='/tags/'>标签</a></h3>
<div class="tagcloud">
    
    <a href="https://www.pigaunt.top/tags/misc/">misc</a>
    
    <a href="https://www.pigaunt.top/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/">动态规划</a>
    
    <a href="https://www.pigaunt.top/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/">字符串</a>
    
    <a href="https://www.pigaunt.top/tags/%E6%95%B0%E5%AD%A6/">数学</a>
    
    <a href="https://www.pigaunt.top/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a>
    
</div>
    </section>

    
<section class="widget">
    <h3 class="widget-title">友情链接</h3>
    <ul class="widget-list">
        
        <li>
            <a target="_blank" href="https://rusun.blog.luogu.org/" title="RuSun的博客">RuSun的博客</a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://www.pigaunt.top/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>